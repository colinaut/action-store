var p=Object.defineProperty;var m=(e,o,t)=>o in e?p(e,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[o]=t;var h=(e,o,t)=>(m(e,typeof o!="symbol"?o+"":o,t),t);function f(e){try{const o=JSON.parse(e);return!!o&&typeof o=="object"}catch{return!1}}function u(e){return e instanceof HTMLInputElement}function S(e){return u(e)||e instanceof HTMLSelectElement||e instanceof HTMLTextAreaElement}function d(e){return u(e)&&e.type==="checkbox"}function E(e){return u(e)&&e.type==="radio"}class v extends HTMLElement{constructor(){super();h(this,"getStoreElements");const t=this.getAttribute("event-type")||"change";this.addEventListener(t,i=>{const s=this.store;if(!s)return;const r=i.target;if(S(r)&&r.hasAttribute("data-set-store")){let n=(d(r)||E(r))&&!r.checked?"":r.value;const a=r.dataset.setStore,l=localStorage.getItem(s)||"{}";if(this.log("setStore",s,n,a,l),a){const g=l&&f(l)?JSON.parse(l):{};g[a]=n,n=JSON.stringify(g)}this.log("setStore: store",s,n),localStorage.setItem(s,n),window.dispatchEvent(new StorageEvent("storage",{key:s,oldValue:l,newValue:n}))}}),this.hasAttribute("store-listen")&&window.addEventListener("storage",i=>{const s=this.store;s&&i.key===s&&this.getStoreForAllElements()})}get store(){return this.getAttribute("store")}connectedCallback(){this.getStoreElements=this.querySelectorAll("[data-get-store]"),this.getStoreForAllElements()}getStoreForAllElements(){this.getStoreElements.forEach(t=>{this.getStore(t)})}getStore(t){const i=this.store;if(!i)return;const s=localStorage.getItem(i);if(!s)return;const r=t.dataset.getStore,c=r&&f(s)?JSON.parse(s)[r]:s;if(this.log("getStore",i,r,c),c!==void 0)if(S(t)){let n=!1;if(d(t)||E(t)){const a=t.checked;t.checked=t.value===c,n=t.checked!==a}else t.value!==c.toString()&&(t.value=c.toString(),n=!0);n&&t.dispatchEvent(new Event("change",{bubbles:!0}))}else t.textContent=c.toString()}log(...t){this.hasAttribute("debug")}}customElements.define("action-store",v);
//# sourceMappingURL=action-store.js.map
